import{C as a}from"./utils-CtQT1Vl0.js";var i={};const n={PASSWORD_MIN_LENGTH:8,RATE_LIMIT_WINDOW:15*60*1e3,RATE_LIMIT_MAX_REQUESTS:100};class u{static SECRET_KEY=i.REACT_APP_ENCRYPTION_KEY||"default-secret-key-change-in-production";static encrypt(t){return a.AES.encrypt(t,this.SECRET_KEY).toString()}static decrypt(t){return a.AES.decrypt(t,this.SECRET_KEY).toString(a.enc.Utf8)}static hashPassword(t){return a.SHA256(t+this.SECRET_KEY).toString()}static generateSecureToken(t=32){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let s="";for(let r=0;r<t;r++)s+=e.charAt(Math.floor(Math.random()*e.length));return s}static validatePasswordStrength(t){const e=[];return t.length<n.PASSWORD_MIN_LENGTH&&e.push(`Password must be at least ${n.PASSWORD_MIN_LENGTH} characters long`),/[A-Z]/.test(t)||e.push("Password must contain at least one uppercase letter"),/[a-z]/.test(t)||e.push("Password must contain at least one lowercase letter"),/\d/.test(t)||e.push("Password must contain at least one number"),/[!@#$%^&*(),.?":{}|<>]/.test(t)||e.push("Password must contain at least one special character"),{isValid:e.length===0,errors:e}}static sanitizeHtml(t){const e=document.createElement("div");return e.textContent=t,e.innerHTML}static validateEmail(t){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t)}static validateUrl(t){try{return new URL(t),!0}catch{return!1}}static detectXSS(t){return[/<script[^>]*>.*?<\/script>/gi,/javascript:/gi,/on\w+\s*=/gi,/<iframe[^>]*>.*?<\/iframe>/gi,/<object[^>]*>.*?<\/object>/gi,/<embed[^>]*>.*?<\/embed>/gi,/<link[^>]*>.*?<\/link>/gi,/<meta[^>]*>.*?<\/meta>/gi,/<style[^>]*>.*?<\/style>/gi,/expression\s*\(/gi,/url\s*\(/gi,/vbscript:/gi,/data:text\/html/gi].some(s=>s.test(t))}static createRateLimiter(){const t=new Map;return e=>{const s=Date.now(),r=t.get(e);return!r||s>r.resetTime?(t.set(e,{count:1,resetTime:s+n.RATE_LIMIT_WINDOW}),!0):r.count>=n.RATE_LIMIT_MAX_REQUESTS?!1:(r.count++,!0)}}static generateCSRFToken(){return this.generateSecureToken(32)}static validateCSRFToken(t,e){return t===e}}export{u as S};
